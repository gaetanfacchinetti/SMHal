\hypertarget{_power_spectrum_8h_source}{}\doxysection{Power\+Spectrum.\+h}
\label{_power_spectrum_8h_source}\index{/Users/facchinettigaetan/Documents/Etudes/PhD\_projects/SMHal/src/headers/PowerSpectrum.h@{/Users/facchinettigaetan/Documents/Etudes/PhD\_projects/SMHal/src/headers/PowerSpectrum.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef DEF\_POWERSPECTRUM}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define DEF\_POWERSPECTRUM}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#include "{}CppLib.h"{}}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#include "{}mymath.h"{}}}
\DoxyCodeLine{6 \textcolor{preprocessor}{\#include "{}Cosmology.h"{}}}
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include "{}TransferFunction.h"{}}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include "{}myspline.h"{}}}
\DoxyCodeLine{9 }
\DoxyCodeLine{10 \textcolor{keyword}{enum class} PSWindowType}
\DoxyCodeLine{11 \{}
\DoxyCodeLine{12   real\_space\_top\_hat,}
\DoxyCodeLine{13   gaussian,}
\DoxyCodeLine{14   fourier\_space\_top\_hat}
\DoxyCodeLine{15 \};}
\DoxyCodeLine{16 }
\DoxyCodeLine{17 \textcolor{keyword}{class }\mbox{\hyperlink{class_power_spectrum}{PowerSpectrum}}}
\DoxyCodeLine{18 \{}
\DoxyCodeLine{19 \textcolor{keyword}{public}:}
\DoxyCodeLine{20   \mbox{\hyperlink{class_power_spectrum}{PowerSpectrum}}()\{\};}
\DoxyCodeLine{21   \mbox{\hyperlink{class_power_spectrum}{PowerSpectrum}}(\mbox{\hyperlink{class_cosmology}{Cosmology}} n\_Cosmo, PSWindowType w = PSWindowType::real\_space\_top\_hat, \textcolor{keywordtype}{bool} n\_normalised\_s8 = \textcolor{keyword}{false});}
\DoxyCodeLine{22   \mbox{\hyperlink{class_power_spectrum}{\string~PowerSpectrum}}()\{\};}
\DoxyCodeLine{23 }
\DoxyCodeLine{24   \textcolor{keywordtype}{void} set\_spikes(std::vector<double> n\_as\_spike, std::vector<double> n\_ks\_spike, std::vector<double> n\_eps\_spike);}
\DoxyCodeLine{25   \textcolor{keywordtype}{void} reset\_spikes() \{As\_spike.resize(0); ks\_spike.resize(0); eps\_spike.resize(0); eps\_spike\_0.resize(0);\};}
\DoxyCodeLine{26   \textcolor{keywordtype}{double} regulator\_spikes(\textcolor{keywordtype}{double} k, \textcolor{keywordtype}{double} ks\_spike, \textcolor{keywordtype}{double} eps);}
\DoxyCodeLine{27 }
\DoxyCodeLine{28   \textcolor{keywordtype}{double} dimensionless\_curvature\_power\_spectrum(\textcolor{keywordtype}{double} k);}
\DoxyCodeLine{29   \textcolor{keywordtype}{double} curvature\_power\_spectrum(\textcolor{keywordtype}{double} k);}
\DoxyCodeLine{30   \textcolor{keywordtype}{double} matter\_power\_spectrum(\textcolor{keywordtype}{double} k, \textcolor{keywordtype}{double} z);}
\DoxyCodeLine{31   \textcolor{keywordtype}{double} dimensionless\_matter\_power\_spectrum(\textcolor{keywordtype}{double} k, \textcolor{keywordtype}{double} z);}
\DoxyCodeLine{32 }
\DoxyCodeLine{33   \textcolor{keywordtype}{void} plot\_PowerSpectrum(\textcolor{keywordtype}{double} z, std::string add = \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{34   }
\DoxyCodeLine{35 }
\DoxyCodeLine{36   \textcolor{keywordtype}{double} Window(\textcolor{keywordtype}{double} kR);}
\DoxyCodeLine{37   \textcolor{keywordtype}{double} Der\_Window\_vs\_kR(\textcolor{keywordtype}{double} kR);}
\DoxyCodeLine{38   \textcolor{keywordtype}{double} LagrangianRadius\_vs\_Mass(\textcolor{keywordtype}{double} Mass);}
\DoxyCodeLine{39   \textcolor{keywordtype}{double} Mass\_vs\_LagrangianRadius(\textcolor{keywordtype}{double} Radius);}
\DoxyCodeLine{40   \textcolor{keywordtype}{double} Der\_Mass\_vs\_LagrangianRadius(\textcolor{keywordtype}{double} Mass);}
\DoxyCodeLine{41 }
\DoxyCodeLine{47   \textcolor{keywordtype}{double} \mbox{\hyperlink{class_power_spectrum_a5dffa98252d22c0a3c5c5836f1bcff29}{SigmaM}}(\textcolor{keywordtype}{double} M, \textcolor{keywordtype}{double} z) \{ \textcolor{keywordflow}{return} SigmaR(LagrangianRadius\_vs\_Mass(M), z); \}; \textcolor{comment}{// M in Msol}}
\DoxyCodeLine{48   \textcolor{keywordtype}{double} SigmaR(\textcolor{keywordtype}{double} R, \textcolor{keywordtype}{double} z) \{ \textcolor{keywordflow}{return} sqrt(SigmaR2(R, z)); \};             \textcolor{comment}{// R in Mpc}}
\DoxyCodeLine{49   \textcolor{keywordtype}{double} SigmaR2(\textcolor{keywordtype}{double} R, \textcolor{keywordtype}{double} z);}
\DoxyCodeLine{50   \textcolor{keywordtype}{double} SigmaM2(\textcolor{keywordtype}{double} M, \textcolor{keywordtype}{double} z) \{ \textcolor{keywordflow}{return} SigmaR2(LagrangianRadius\_vs\_Mass(M), z); \};}
\DoxyCodeLine{51   \textcolor{keywordtype}{double} fForDichotomie\_Mass\_vs\_Sigma2(\textcolor{keywordtype}{double} M, \textcolor{keywordtype}{double} sM2, \textcolor{keywordtype}{double} z);}
\DoxyCodeLine{52   \textcolor{keywordtype}{double} Mass\_vs\_Sigma2(\textcolor{keywordtype}{double} sM2, \textcolor{keywordtype}{double} z);}
\DoxyCodeLine{53   \textcolor{keywordtype}{double} fToIntFor\_Sigma2R(std::vector<double> lnkRz);}
\DoxyCodeLine{54 }
\DoxyCodeLine{55   \textcolor{keywordtype}{double} Der\_LnSigmaR\_vs\_R(\textcolor{keywordtype}{double} R, \textcolor{keywordtype}{double} z) \{ \textcolor{keywordflow}{return} 0.5 * pow(SigmaR(R, z), -\/2) * Der\_sigmaR2\_vs\_R(R, z); \};}
\DoxyCodeLine{56   \textcolor{keywordtype}{double} Der\_LnSigmaM\_vs\_M(\textcolor{keywordtype}{double} M, \textcolor{keywordtype}{double} z) \{ \textcolor{keywordflow}{return} Der\_LnSigmaR\_vs\_R(LagrangianRadius\_vs\_Mass(M), z) / Der\_Mass\_vs\_LagrangianRadius(M); \};}
\DoxyCodeLine{57   \textcolor{keywordtype}{double} Der\_sigmaR2\_vs\_R(\textcolor{keywordtype}{double} R, \textcolor{keywordtype}{double} z);}
\DoxyCodeLine{58   \textcolor{keywordtype}{double} Der\_sigmaM2\_vs\_M(\textcolor{keywordtype}{double} M, \textcolor{keywordtype}{double} z) \{ \textcolor{keywordflow}{return} Der\_sigmaR2\_vs\_R(LagrangianRadius\_vs\_Mass(M), z) / Der\_Mass\_vs\_LagrangianRadius(M); \};}
\DoxyCodeLine{59   \textcolor{keywordtype}{double} fToIntFor\_Der\_sigmaR2\_vs\_R(std::vector<double> kRz);}
\DoxyCodeLine{60 }
\DoxyCodeLine{67   \textcolor{comment}{//double SigmaM\_spike(double M, double As, double ks, double z) \{return sqrt(SigmaM2\_spike(M, As, ks, z)); \};}}
\DoxyCodeLine{68   \textcolor{keywordtype}{double} \mbox{\hyperlink{class_power_spectrum_a8fbfe4dbb9afed749622fade7ab2ebf1}{SigmaR2\_narrow\_spike\_over\_window}}(\textcolor{keywordtype}{double} As\_spike, \textcolor{keywordtype}{double} ks\_spike, \textcolor{keywordtype}{double} z);}
\DoxyCodeLine{69   \textcolor{keywordtype}{double} SigmaR2\_narrow\_spike(\textcolor{keywordtype}{double} R, \textcolor{keywordtype}{double} As\_spike, \textcolor{keywordtype}{double} ks\_spike, \textcolor{keywordtype}{double} z);}
\DoxyCodeLine{70 }
\DoxyCodeLine{71 }
\DoxyCodeLine{72   \textcolor{keywordtype}{void} Interpolate\_SigmaM2\_vs\_M(\textcolor{keywordtype}{double} z);}
\DoxyCodeLine{73   \textcolor{keywordtype}{double} \mbox{\hyperlink{class_power_spectrum_ac7e1d33a64567b11c1669b7b372f4076}{Interp\_SigmaM2}}(\textcolor{keywordtype}{double} M, \textcolor{keywordtype}{double} z);}
\DoxyCodeLine{74 }
\DoxyCodeLine{75   \textcolor{keywordtype}{void} plot\_SigmaM\_vs\_z(\textcolor{keywordtype}{double} M);}
\DoxyCodeLine{76   \textcolor{keywordtype}{void} plot\_Sigma\_vs\_RM(\textcolor{keywordtype}{double} z, \textcolor{keywordtype}{bool} with\_respect\_to\_M, \textcolor{keywordtype}{bool} in\_units\_of\_h = \textcolor{keyword}{false}, std::string add = \textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{77   \textcolor{keywordtype}{void} plot\_Der\_LnSigma\_vs\_LnRM(\textcolor{keywordtype}{double} z, \textcolor{keywordtype}{bool} with\_respect\_to\_M = \textcolor{keyword}{false}, \textcolor{keywordtype}{bool} in\_units\_of\_h = \textcolor{keyword}{false});}
\DoxyCodeLine{78   \textcolor{keywordtype}{void} plot\_fToIntFor\_Sigma2R(\textcolor{keywordtype}{double} z, \textcolor{keywordtype}{double} R);}
\DoxyCodeLine{79 }
\DoxyCodeLine{80   \mbox{\hyperlink{class_cosmology}{Cosmology}} get\_Cosmology()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} Cosmo; \};}
\DoxyCodeLine{81   PSWindowType get\_window()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} window\_type; \};}
\DoxyCodeLine{82   }
\DoxyCodeLine{83   std::vector<double> get\_ks\_spike()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} ks\_spike;\};}
\DoxyCodeLine{84   std::vector<double> get\_As\_spike()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} As\_spike;\};}
\DoxyCodeLine{85 }
\DoxyCodeLine{86   \textcolor{keywordtype}{double} VolumeForm();}
\DoxyCodeLine{87 }
\DoxyCodeLine{88   \textcolor{keyword}{static} \textcolor{keywordtype}{double} CallBack\_fToIntFor\_Sigma2R(\textcolor{keywordtype}{void} *pt2Object, std::vector<double> xx) \{ \textcolor{keywordflow}{return} ((\mbox{\hyperlink{class_power_spectrum}{PowerSpectrum}} *)pt2Object)-\/>fToIntFor\_Sigma2R(xx); \};}
\DoxyCodeLine{89   \textcolor{keyword}{static} \textcolor{keywordtype}{double} CallBack\_fToIntFor\_Der\_sigmaR2\_vs\_R(\textcolor{keywordtype}{void} *pt2Object, std::vector<double> xx) \{ \textcolor{keywordflow}{return} ((\mbox{\hyperlink{class_power_spectrum}{PowerSpectrum}} *)pt2Object)-\/>fToIntFor\_Der\_sigmaR2\_vs\_R(xx); \};}
\DoxyCodeLine{90   \textcolor{keyword}{static} \textcolor{keywordtype}{double} CallBack\_fForDichotomie\_Mass\_vs\_SigmaM2(\textcolor{keywordtype}{void} *pt2Object, std::vector<double> xx) \{ \textcolor{keywordflow}{return} ((\mbox{\hyperlink{class_power_spectrum}{PowerSpectrum}} *)pt2Object)-\/>fForDichotomie\_Mass\_vs\_Sigma2(xx[0], xx[1], xx[2]); \};}
\DoxyCodeLine{91 }
\DoxyCodeLine{92 \textcolor{keyword}{private}:}
\DoxyCodeLine{93   \mbox{\hyperlink{class_cosmology}{Cosmology}} Cosmo;}
\DoxyCodeLine{94   \mbox{\hyperlink{class_transfer_function}{TransferFunction}} TF;}
\DoxyCodeLine{95 }
\DoxyCodeLine{96   PSWindowType window\_type;}
\DoxyCodeLine{97   \textcolor{keywordtype}{double} gamma\_rs\_th, gamma\_gaussian, gamma\_fs\_th;}
\DoxyCodeLine{98 }
\DoxyCodeLine{99   \textcolor{keywordtype}{double} k0;     \textcolor{comment}{// pivot scale}}
\DoxyCodeLine{100   \textcolor{keywordtype}{double} ns, As; \textcolor{comment}{// spectral index and spectral amplitude}}
\DoxyCodeLine{101   }
\DoxyCodeLine{102   std::vector<double> As\_spike, ks\_spike, eps\_spike;}
\DoxyCodeLine{103   std::vector<int> eps\_spike\_0; \textcolor{comment}{// spikes for which eps\_spike = 0 -\/> true delta function}}
\DoxyCodeLine{104 }
\DoxyCodeLine{105   my\_spline::spline spline\_sigmaM2\_vs\_log10\_M;}
\DoxyCodeLine{106   \textcolor{keywordtype}{bool} is\_interpolated\_SigmaM2;}
\DoxyCodeLine{107   \textcolor{keywordtype}{double} \_z\_interp;}
\DoxyCodeLine{108 }
\DoxyCodeLine{109   \textcolor{keywordtype}{bool} normalised\_s8;}
\DoxyCodeLine{110   \textcolor{keywordtype}{double} norm\_PS;}
\DoxyCodeLine{111 \};}
\DoxyCodeLine{112 }
\DoxyCodeLine{113 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
